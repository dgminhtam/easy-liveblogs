(()=>{function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}!function(){"use strict";var e=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.documentTitle=document.title,this.firstLoad=!0,this.newPosts=0,this.timestamp=!1,this.loader=null,this.showNewButton=null,this.loadMoreButton=null,this.list=null,this.statusMessage=null,this.settings=null,this.latestTimestamp=0,this.lightbox=null,this.lightboxImg=null,this.init()}var i,n,o;return i=e,n=[{key:"init",value:function(){var t=this;if(this.container){this.showNewButton=this.container.querySelector("#elb-show-new-posts"),this.loadMoreButton=this.container.querySelector("#elb-load-more"),this.loader=this.container.querySelector(".elb-loader"),this.list=this.container.querySelector(".elb-liveblog-list"),this.statusMessage=this.container.querySelector(".elb-liveblog-closed-message"),this.initLightbox(),this.fetchFeed(),this.showNewButton&&this.showNewButton.addEventListener("click",(function(){return t.showNew()})),this.loadMoreButton&&this.loadMoreButton.addEventListener("click",(function(){return t.loadMore()})),this.initContentProtection();var e=this.container.dataset.paginationType,i=elb.pagination_type;this.paginationMode=e&&"default"!==e?e:i||"button",this.isLoading=!1,this.observer=null,"infinite"===this.paginationMode&&(this.loadMoreButton&&(this.loadMoreButton.style.display="none"),this.sentinel=document.createElement("div"),this.sentinel.className="elb-infinite-scroll-sentinel",this.container.appendChild(this.sentinel),this.setupInfiniteScroll())}}},{key:"setupInfiniteScroll",value:function(){var t=this;"IntersectionObserver"in window?(this.observer=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&!t.isLoading&&t.list.querySelectorAll("li.elb-hide.elb-liveblog-initial-post").length>0&&t.loadMore()}))}),{root:null,rootMargin:"0px",threshold:.1}),this.sentinel&&this.observer.observe(this.sentinel)):this.loadMoreButton&&(this.loadMoreButton.style.display="block")}},{key:"initContentProtection",value:function(){var t="1"===elb.content_protection||!0===elb.content_protection,e="1"===this.container.dataset.contentProtection;(t||e)&&(this.container.style.userSelect="none",this.container.style.webkitUserSelect="none",this.container.style.mozUserSelect="none",this.container.style.msUserSelect="none",this.container.addEventListener("contextmenu",(function(t){return t.preventDefault(),!1})),this.container.addEventListener("keydown",(function(t){if((t.ctrlKey||t.metaKey)&&"c"===t.key)return t.preventDefault(),!1})),this.container.addEventListener("selectstart",(function(t){return t.preventDefault(),!1})))}},{key:"fetchFeed",value:function(){var t=this,e=this.getEndpoint();fetch(e).then((function(t){return t.json()})).then((function(e){t.settings=e.settings||{};var i=[];if(t.loader&&(t.loader.style.display="none"),t.list.querySelectorAll(".elb-new").forEach((function(t){return t.remove()})),t.resetUpdateCounter(),e.updates.forEach((function(e,n){e.timestamp&&e.timestamp>t.latestTimestamp&&(t.latestTimestamp=parseInt(e.timestamp));var o=!1,l=t.list.querySelector('li[data-elb-post-id="'.concat(e.id,'"]'));if(t.firstLoad){var s=t.renderPost(e);if(n+1>t.container.dataset.showEntries&&(s.classList.add("elb-hide","elb-liveblog-initial-post"),t.loadMoreButton&&(t.loadMoreButton.style.display="block")),e.id==t.container.dataset.highlightedEntry&&(o=!0,s.classList.add("elb-liveblog-highlight"),s.classList.remove("elb-hide")),t.list.appendChild(s),o){var a=t.list.querySelector('li[data-elb-post-id="'.concat(e.id,'"]'));a&&window.scrollTo(0,a.offsetTop)}}else if(t.firstLoad||!l){if(!t.firstLoad&&!l){var r=t.renderPost(e);r.classList.add("elb-new"),t.newPosts++,i.push(r)}}else{var c=t.renderPost(e),u=l.querySelector("time"),d=c.querySelector("time");u&&d&&u.replaceWith(d);var h=l.querySelector(".elb-liveblog-post-heading"),b=c.querySelector(".elb-liveblog-post-heading");if(h&&b&&h.replaceWith(b),0===l.querySelectorAll(".elb-liveblog-post-content iframe").length){var f=l.querySelector(".elb-liveblog-post-content"),m=c.querySelector(".elb-liveblog-post-content");f&&m&&f.replaceWith(m)}}})),i.length>0&&i.reverse().forEach((function(e){t.list.insertBefore(e,t.list.firstChild)})),"function"==typeof elb_after_feed_load&&elb_after_feed_load(e),t.firstLoad=!1,0===t.list.querySelectorAll("li").length){var n=t.container.querySelector(".elb-no-liveblog-entries-message");n&&(n.style.display="block")}t.newPosts>0&&(t.showNew(),"function"==typeof elb_after_update_liveblog_callback&&elb_after_update_liveblog_callback()),"human"===elb.datetime_format&&t.updateTimestamps(),"closed"===e.status?t.statusMessage&&(t.statusMessage.style.display="block"):setTimeout((function(){return t.poll()}),1e3*elb.interval)})).catch((function(e){console.error("Easy Liveblogs: Error fetching feed",e),setTimeout((function(){return t.poll()}),1e3*elb.interval)}))}},{key:"poll",value:function(){var t=this,e=this.getEndpoint("/check");fetch(e).then((function(t){return t.json()})).then((function(e){"closed"!==e.status?parseInt(e.timestamp)>t.latestTimestamp?t.fetchFeed():("human"===elb.datetime_format&&t.updateTimestamps(),setTimeout((function(){return t.poll()}),1e3*elb.interval)):t.statusMessage&&(t.statusMessage.style.display="block")})).catch((function(e){console.error("Easy Liveblogs: Error checking updates",e),setTimeout((function(){return t.poll()}),1e3*elb.interval)}))}},{key:"initLightbox",value:function(){var t=this;if(document.querySelector(".elb-lightbox"))return this.lightbox=document.querySelector(".elb-lightbox"),void(this.lightboxImg=this.lightbox.querySelector("img"));document.body.insertAdjacentHTML("beforeend",'<div class="elb-lightbox"><img src="" alt="Liveblog Lightbox"></div>'),this.lightbox=document.querySelector(".elb-lightbox"),this.lightboxImg=this.lightbox.querySelector("img"),this.lightbox.addEventListener("click",(function(){t.lightbox.classList.remove("active")}))}},{key:"bindLightbox",value:function(t){var e=this;t.querySelectorAll(".elb-liveblog-post-content img").forEach((function(t){t.style.cursor="zoom-in",t.addEventListener("click",(function(i){i.stopPropagation(),e.lightboxImg.src=t.src,e.lightbox.classList.add("active")}))}))}},{key:"renderPost",value:function(t){var e=document.createElement("li");e.className="elb-liveblog-post",e.dataset.elbPostDatetime=t.timestamp,e.dataset.elbPostId=t.id;var i="";return i+=this.renderTime(t),this.settings.showAuthor&&(i+=this.renderAuthor(t)),i+='<h2 class="elb-liveblog-post-heading">'.concat(t.title,"</h2>"),i+='<div class="elb-liveblog-post-content">'.concat(t.content,"</div>"),this.settings.showSharing&&(i+=this.renderSharing(t)),this.settings.isEditor&&(i+=this.renderActions(t)),e.innerHTML=i,this.bindLightbox(e),e}},{key:"renderTime",value:function(t){if("human"===elb.datetime_format){var e=this.getTimeAgo(t.datetime);return'<p class="elb-liveblog-post-time"><time class="elb-js-update-time" datetime="'.concat(t.datetime,'">').concat(e,"</time></p>")}return'<p class="elb-liveblog-post-time"><time datetime="'.concat(t.datetime,'">').concat(t.time,"</time></p>")}},{key:"renderAuthor",value:function(t){var e=t.author?this.escapeHtml(t.author):"";return'<p class="elb-liveblog-post-author">By '.concat(e,"</p>")}},{key:"renderSharing",value:function(t){var e="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(t.permalink)),i="https://x.com/intent/tweet?text=".concat(encodeURIComponent(t.title)," ").concat(encodeURIComponent(t.permalink)),n="mailto:?&subject=".concat(encodeURIComponent(t.title),"&body=").concat(encodeURIComponent(t.permalink)),o=this.settings.socialIcons||{},l=o.facebook||"",s=o.x||"",a=o.mail||"";return'\n\t\t\t\t<div class="elb-liveblog-post-sharing">\n\t\t\t\t\t<a href="'.concat(e,'" target="_blank" title="Share via Facebook">\n\t\t\t\t\t\t').concat(l,'\n\t\t\t\t\t</a>\n\t\t\t\t\t<a href="').concat(i,'" target="_blank" title="Share via X/Twitter">\n\t\t\t\t\t\t').concat(s,'\n\t\t\t\t\t</a>\n\t\t\t\t\t<a href="').concat(n,'" target="_blank" title="Share via email">\n\t\t\t\t\t\t').concat(a,"\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t")}},{key:"renderActions",value:function(t){var e="".concat(window.location.origin,"/wp-admin/post.php?post=").concat(t.id,"&action=edit");return'\n\t\t\t\t<div class="elb-liveblog-actions">\n\t\t\t\t\t<a href="'.concat(e,'" rel="nofollow">Edit This</a>\n\t\t\t\t</div>\n\t\t\t')}},{key:"escapeHtml",value:function(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}},{key:"getTime",value:function(){var t=(new Date).getTime();return 0===t?0:Math.round(t/6e4)}},{key:"getEndpoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.container.dataset.endpoint;if(t&&(e+=t),"1"===this.container.dataset.appendTimestamp){var i=e.includes("?")?"&":"?";e=e+i+"_="+this.getTime()}return e}},{key:"showNew",value:function(){this.list.querySelectorAll('li.elb-new:not([style*="display: none"])').forEach((function(t){t.classList.remove("elb-new")})),this.showNewButton&&(this.showNewButton.style.display="none"),this.resetUpdateCounter()}},{key:"resetUpdateCounter",value:function(){this.newPosts=0,document.title=this.documentTitle}},{key:"loadMore",value:function(){var t=this;if(!this.isLoading){this.isLoading=!0,"infinite"===this.paginationMode&&this.loader&&(this.loader.style.display="block");var e=this.list.querySelectorAll("li.elb-hide.elb-liveblog-initial-post"),i=parseInt(this.container.dataset.showEntries)||10,n=0;e.forEach((function(t,e){n<i&&(t.classList.remove("elb-hide"),n++)})),this.isLoading=!1,"infinite"===this.paginationMode&&this.loader&&(this.loader.style.display="none"),0===this.list.querySelectorAll("li.elb-hide.elb-liveblog-initial-post").length&&this.loadMoreButton&&(this.loadMoreButton.textContent=elb.now_more_posts,"infinite"!==this.paginationMode?setTimeout((function(){t.loadMoreButton.style.opacity="0",t.loadMoreButton.style.transition="opacity 1s",setTimeout((function(){t.loadMoreButton.style.display="none"}),1e3)}),2e3):(this.loadMoreButton.style.display="none",this.observer&&this.sentinel&&this.observer.unobserve(this.sentinel))),"function"==typeof elb_after_load_more_callback&&elb_after_load_more_callback()}}},{key:"updateTimestamps",value:function(){var t=this;this.list.querySelectorAll("li").forEach((function(e){var i=e.querySelector(".elb-js-update-time");if(i){var n=i.getAttribute("datetime");i.textContent=t.getTimeAgo(n)}}))}},{key:"getTimeAgo",value:function(t){var e=new Date(t),i=(new Date-e)/1e3,n=elb.locale.replace("_","-");if("undefined"==typeof Intl||void 0===Intl.RelativeTimeFormat)return e.toLocaleDateString();var o=new Intl.RelativeTimeFormat(n,{numeric:"auto"});return i<60?o.format(-Math.round(i),"seconds"):i<3600?o.format(-Math.round(i/60),"minutes"):i<86400?o.format(-Math.round(i/3600),"hours"):i<2592e3?o.format(-Math.round(i/86400),"days"):i<31536e3?o.format(-Math.round(i/2592e3),"months"):o.format(-Math.round(i/31536e3),"years")}}],n&&t(i.prototype,n),o&&t(i,o),Object.defineProperty(i,"prototype",{writable:!1}),e}();window.ELB={init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){var i=t.querySelector(".elb-liveblog");i&&!i.dataset.elbInitialized&&(new e(i),i.dataset.elbInitialized="true")}else{var n=document.querySelectorAll(".elb-liveblog");n.forEach((function(t){t.dataset.elbInitialized||(new e(t),t.dataset.elbInitialized="true")}))}}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){return window.ELB.init()})):window.ELB.init(),window.addEventListener("elementor/frontend/init",(function(){elementorFrontend.hooks.addAction("frontend/element_ready/elb_liveblog.default",(function(t){window.ELB.init(t[0])}))}))}()})();